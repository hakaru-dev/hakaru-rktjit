((fn
  topic_prior
  ((array prob)
   ->
   ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (measure nat))))))
  ((fn
    word_prior
    ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (measure nat)))))
    ((fn
      z
      ((array nat) -> ((array nat) -> (nat -> (measure nat))))
      ((fn
        w
        ((array nat) -> (nat -> (measure nat)))
        ((fn
          doc
          (nat -> (measure nat))
          ((fn
            docUpdate
            (measure nat)
            ((categorical
              ((array
                (zNew丏 ((size (topic_prior : (array prob))) : nat))
                  ((+
                    ((let (summary
                           (pair unit (array nat))
                           ((bucket
                             (0 : nat)
                             ((size (z : (array nat))) : nat)
                             (r_split
                              (bind
                               i丙
                               ((== (i丙 : nat) (docUpdate : nat)) : bool))
                              r_nop
                              (r_index
                               ((size (topic_prior : (array prob))) : nat)
                               (bind
                                i丙
                                ((index (z : (array nat)) (i丙 : nat)) : nat))
                               (r_add (bind i丙 (bind zNew丏 (1 : nat)))))))
                            :
                            (pair unit (array nat))))
                       ((nat2prob
                         ((index
                           ((match
                             (summary : (pair unit (array nat)))
                             ((datum
                               pair
                               (pc_inl
                                (ps_et
                                 (pf_konst var)
                                 (ps_et (pf_konst var) (ps_done)))))
                              (bind y (bind z z))))
                            :
                            (array nat))
                           (zNew丏 : nat))
                          :
                          nat))
                        :
                        prob))
                     :
                     prob)
                    ((index (topic_prior : (array prob)) (zNew丏 : nat))
                     :
                     prob))
                   :
                   prob))
               :
               (array prob)))
             :
             (measure nat)))
           :
           (nat -> (measure nat))))
         :
         ((array nat) -> (nat -> (measure nat)))))
       :
       ((array nat) -> ((array nat) -> (nat -> (measure nat))))))
     :
     ((array nat)
      ->
      ((array nat) -> ((array nat) -> (nat -> (measure nat)))))))
   :
   ((array prob)
    ->
    ((array nat)
     ->
     ((array nat) -> ((array nat) -> (nat -> (measure nat))))))))
 :
 ((array prob)
  ->
  ((array prob)
   ->
   ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (measure nat))))))))
