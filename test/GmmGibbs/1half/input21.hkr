((fn
     s
   ((array prob) -> ((array nat) -> ((array real) -> (nat -> (array prob)))))
   ((fn
        as
      ((array nat) -> ((array real) -> (nat -> (array prob))))
      ((fn
           z
         ((array real) -> (nat -> (array prob)))
         ((fn
              t
            (nat -> (array prob))
            ((fn
                 docUpdate
               (array prob)
               ((array
                 (zNewd ((size (as : (array prob))) : nat))
                 ((int2real
                   ((let (summary
                          (array nat)
                          ((bucket
                            ((nat_ 0) : nat)
                            ((size (t : (array real))) : nat)
                            (r_index
                             ((size (as : (array prob))) : nat)
                             (bind _a ((index (z : (array nat)) (_a : nat)) : nat))
                             (r_add (bind _a (bind zNewd ((nat_ 1) : nat))))))
                           : (array nat)))
                      ((nat2int
                        ((index (summary : (array nat)) (zNewd : nat)) : nat)
                        )
                       :
                       int)
                      ;; ((+
                      ;;   ((*
                      ;;     ((nat2int
                      ;;       ((match
                      ;;            ((==
                      ;;              (zNewd : nat)
                      ;;              ((index
                      ;;                (z : (array nat))
                      ;;                (docUpdate : nat))
                      ;;               :
                      ;;               nat))
                      ;;             :
                      ;;             bool)
                      ;;          ((pdatum true (pc_inl (ps_done)))
                      ;;           ((nat_ 1) : nat))
                      ;;          ((pdatum
                      ;;            false
                      ;;            (pc_inr (pc_inl (ps_done))))
                      ;;           ((nat_ 0) : nat)))
                      ;;        :
                      ;;        nat))
                      ;;      :
                      ;;      int)
                      ;;     ((int_ -1) : int))
                      ;;    :
                      ;;    int)
                      ;;   ((nat2int
                      ;;     ((index
                      ;;       (summary : (array nat))
                      ;;       (zNewd : nat))
                      ;;      :
                      ;;      nat))
                      ;;    :
                      ;;    int))
                      ;;  :
                      ;;  int)
                      )
                    :
                    int)


                   )
                  :
                  real))
                :
                (array prob)))
             :
             (nat -> (array prob))))
          :
          ((array real) -> (nat -> (array prob)))))
       :
       ((array nat) -> ((array real) -> (nat -> (array prob))))))
    :
    ((array prob)
     ->
     ((array nat) -> ((array real) -> (nat -> (array prob)))))))
 :
 (prob
  ->
  ((array prob)
   ->
   ((array nat) -> ((array real) -> (nat -> (array prob)))))))
