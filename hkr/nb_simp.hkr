[(fn topic_prior ((array prob) -> ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob)))))) [(fn word_prior ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob))))) [(fn z ((array nat) -> ((array nat) -> (nat -> (array prob)))) [(fn w ((array nat) -> (nat -> (array prob))) [(fn doc (nat -> (array prob)) [(fn docUpdate (array prob) [(match [(< [docUpdate : nat] [(size [z : (array nat)]) : nat]) : bool] ((datum true (pc_inl (ps_done))) [(array (zNew [(size [topic_prior : (array prob)]) : nat]) [(* [(product (i [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(product (i_a [0 : nat] [(size [word_prior : (array prob)]) : nat]) [(product (j [0 : nat] [(summate (i_b [0 : nat] [(size [w : (array nat)]) : nat]) [(match [(== [docUpdate : nat] [(index [doc : (array nat)] [i_b : nat]) : nat]) : bool] ((datum true (pc_inl (ps_done))) [(match [(and [(== [i : nat] [zNew : nat]) : bool][(== [i_a : nat] [(index [w : (array nat)] [i_b : nat]) : nat]) : bool]) : bool] ((datum true (pc_inl (ps_done))) [1 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat]) : nat]) [(+ [(nat2prob [(summate (i_b [0 : nat] [(size [w : (array nat)]) : nat]) [(match [(== [(index [doc : (array nat)] [i_b : nat]) : nat] [docUpdate : nat]) : bool] ((datum true (pc_inl (ps_done))) [0 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [(match [(and [(== [i : nat] [(index [z : (array nat)] [(index [doc : (array nat)] [i_b : nat]) : nat]) : nat]) : bool][(== [i_a : nat] [(index [w : (array nat)] [i_b : nat]) : nat]) : bool]) : bool] ((datum true (pc_inl (ps_done))) [1 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat])) : nat]) : nat]) : prob][(nat2prob [j : nat]) : prob][(index [word_prior : (array prob)] [i_a : nat]) : prob]) : prob]) : prob]) : prob]) : prob][(+ [(nat2prob [(summate (i_b [0 : nat] [(size [z : (array nat)]) : nat]) [(match [(== [i_b : nat] [docUpdate : nat]) : bool] ((datum true (pc_inl (ps_done))) [0 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [(match [(== [zNew : nat] [(index [z : (array nat)] [i_b : nat]) : nat]) : bool] ((datum true (pc_inl (ps_done))) [1 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat])) : nat]) : nat]) : prob][(index [topic_prior : (array prob)] [zNew : nat]) : prob]) : prob][(recip [(+ [(nat2prob [(summate (i_b [0 : nat] [(size [z : (array nat)]) : nat]) [(match [(== [i_b : nat] [docUpdate : nat]) : bool] ((datum true (pc_inl (ps_done))) [0 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [(match [(< [(index [z : (array nat)] [i_b : nat]) : nat] [0 : nat]) : bool] ((datum true (pc_inl (ps_done))) [0 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [1 : nat])) : nat])) : nat]) : nat]) : prob][(summate (i_b [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(index [topic_prior : (array prob)] [i_b : nat]) : prob]) : prob]) : prob]) : prob][(recip [(product (i [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(product (i_a [0 : nat] [(summate (i_b [0 : nat] [(size [w : (array nat)]) : nat]) [(match [(== [docUpdate : nat] [(index [doc : (array nat)] [i_b : nat]) : nat]) : bool] ((datum true (pc_inl (ps_done))) [(match [(and [(not [(< [(index [w : (array nat)] [i_b : nat]) : nat] [0 : nat]) : bool]) : bool][(== [i : nat] [zNew : nat]) : bool]) : bool] ((datum true (pc_inl (ps_done))) [1 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat]) : nat]) [(+ [(nat2prob [(summate (i_b [0 : nat] [(size [w : (array nat)]) : nat]) [(match [(== [(index [doc : (array nat)] [i_b : nat]) : nat] [docUpdate : nat]) : bool] ((datum true (pc_inl (ps_done))) [0 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [(match [(and [(not [(< [(index [w : (array nat)] [i_b : nat]) : nat] [0 : nat]) : bool]) : bool][(== [i : nat] [(index [z : (array nat)] [(index [doc : (array nat)] [i_b : nat]) : nat]) : nat]) : bool]) : bool] ((datum true (pc_inl (ps_done))) [1 : nat]) ((datum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat])) : nat]) : nat]) : prob][(nat2prob [i_a : nat]) : prob][(summate (i_b [0 : nat] [(size [word_prior : (array prob)]) : nat]) [(index [word_prior : (array prob)] [i_b : nat]) : prob]) : prob]) : prob]) : prob]) : prob]) : prob]) : prob]) : (array prob)]) ((datum false (pc_inr (pc_inl (ps_done)))) [(array (i [0 : nat]) [0 : prob]) : (array prob)])) : (array prob)]) : (nat -> (array prob))]) : ((array nat) -> (nat -> (array prob)))]) : ((array nat) -> ((array nat) -> (nat -> (array prob))))]) : ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob)))))]) : ((array prob) -> ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob))))))]) : ((array prob) -> ((array prob) -> ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob)))))))]
