[(fn topic_prior ((array prob) -> ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob)))))) [(fn word_prior ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob))))) [(fn z ((array nat) -> ((array nat) -> (nat -> (array prob)))) [(fn w ((array nat) -> (nat -> (array prob))) [(fn doc (nat -> (array prob)) [(fn docUpdate (array prob) [(let (topic_prior_size [(size [topic_prior : (array prob)]) : nat] nat) [(let (topic_prior_sum [(summate (i13 [0 : nat] [topic_prior_size : nat]) [(index [topic_prior : (array prob)] [i13 : nat]) : prob]) : prob] prob) [(let (word_prior_size [(size [word_prior : (array prob)]) : nat] nat) [(let (word_prior_sum [(summate (i13 [0 : nat] [word_prior_size : nat]) [(index [word_prior : (array prob)] [i13 : nat]) : prob]) : prob] prob) [(let (count_z [(nat2prob [(summate (i13 [0 : nat] [(size [z : (array nat)]) : nat]) [(match [(== [i13 : nat] [docUpdate : nat]) : data-type] (true [0 : nat]) (false [(match [(< [(index [z : (array nat)] [i13 : nat]) : nat] [0 : nat]) : data-type] (true [0 : nat]) (false [1 : nat])) : nat])) : nat]) : nat]) : prob] prob) [(array (zNew8 [topic_prior_size : nat]) [(let (count_z_znew [(summate (i13 [0 : nat] [(size [z : (array nat)]) : nat]) [(match [(== [i13 : nat] [docUpdate : nat]) : data-type] (true [0 : nat]) (false [(match [(== [zNew8 : nat] [(index [z : (array nat)] [i13 : nat]) : nat]) : data-type] (true [1 : nat]) (false [0 : nat])) : nat])) : nat]) : nat] nat) [(let (inner_product [(product (i [0 : nat] [topic_prior_size : nat]) [(let (upper_bound [(summate (i13 [0 : nat] [(size [w : (array nat)]) : nat]) [(match [(== [docUpdate : nat] [(index [doc : (array nat)] [i13 : nat]) : nat]) : data-type] (true [(match [(and [(not [(< [(index [w : (array nat)] [i13 : nat]) : nat] [0 : nat]) : data-type]) : data-type][(== [i : nat] [zNew8 : nat]) : data-type]) : data-type] (true [1 : nat]) (false [0 : nat])) : nat]) (false [0 : nat])) : nat]) : nat] nat) [(let (count_doc_entries [(nat2prob [(summate (i13 [0 : nat] [(size [w : (array nat)]) : nat]) [(match [(== [(index [doc : (array nat)] [i13 : nat]) : nat] [docUpdate : nat]) : data-type] (true [0 : nat]) (false [(match [(and [(not [(< [(index [w : (array nat)] [i13 : nat]) : nat] [0 : nat]) : data-type]) : data-type][(== [i : nat] [(index [z : (array nat)] [(index [doc : (array nat)] [i13 : nat]) : nat]) : nat]) : data-type]) : data-type] (true [1 : nat]) (false [0 : nat])) : nat])) : nat]) : nat]) : prob] prob) [(let (partial_sum [(+ [count_doc_entries : prob][word_prior_sum : prob]) : prob] prob) [(product (i18 [0 : nat] [upper_bound : nat]) [(+ [partial_sum : prob][(nat2prob [i18 : nat]) : prob]) : prob]) : prob]) : prob]) : prob]) : prob]) : prob] prob) [(product (i [0 : nat] [topic_prior_size : nat]) [(product (i18 [0 : nat] [word_prior_size : nat]) [(let (inner_sum [(summate (i13 [0 : nat] [(size [w : (array nat)]) : nat]) [(match [(== [(index [doc : (array nat)] [i13 : nat]) : nat] [docUpdate : nat]) : data-type] (true [0 : nat]) (false [(match [(and [(== [i : nat] [(index [z : (array nat)] [(index [doc : (array nat)] [i13 : nat]) : nat]) : nat]) : data-type][(== [i18 : nat] [(index [w : (array nat)] [i13 : nat]) : nat]) : data-type]) : data-type] (true [1 : nat]) (false [0 : nat])) : nat])) : nat]) : nat] nat) [(product (j [0 : nat] [(summate (i13 [0 : nat] [(size [w : (array nat)]) : nat]) [(match [(== [docUpdate : nat] [(index [doc : (array nat)] [i13 : nat]) : nat]) : data-type] (true [(match [(and [(== [i : nat] [zNew8 : nat]) : data-type][(== [i18 : nat] [(index [w : (array nat)] [i13 : nat]) : nat]) : data-type]) : data-type] (true [1 : nat]) (false [0 : nat])) : nat]) (false [0 : nat])) : nat]) : nat]) [(* [(+ [(nat2prob [inner_sum : nat]) : prob][(nat2prob [j : nat]) : prob][(index [word_prior : (array prob)] [i18 : nat]) : prob]) : prob][(+ [(nat2prob [count_z_znew : nat]) : prob][(index [topic_prior : (array prob)] [zNew8 : nat]) : prob]) : prob][(recip [(+ [count_z : prob][topic_prior_sum : prob]) : prob]) : prob][(recip [inner_product : prob]) : prob]) : prob]) : prob]) : prob]) : prob]) : prob]) : prob]) : prob]) : (array prob)]) : (array prob)]) : (array prob)]) : (array prob)]) : (array prob)]) : (array prob)]) : (nat -> (array prob))]) : ((array nat) -> (nat -> (array prob)))]) : ((array nat) -> ((array nat) -> (nat -> (array prob))))]) : ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob)))))]) : ((array prob) -> ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob))))))]) : ((array prob) -> ((array prob) -> ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (array prob)))))))]